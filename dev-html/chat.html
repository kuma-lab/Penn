<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../dev-css/chat.css" />
    <link rel="stylesheet" href="../assets/css/chat.css" />
    <title>chat Page</title>
</head>
<body>
    <!-- Header site -->
    <header class="headerSite">
    <a href="home.html" class="linkToHome">
        <img class="logo" src="../assets/img/logo.png" alt="">
    </a>
    <!-- <div class="searchContainer">
        <img src="../assets/img/Search.png" alt="search" class="searchIcon">
        <label class="labelSearch" for="gsearch"></label>
        <input type="search" class="searchInput" id="gsearch" placeholder="search people" name="gsearch">
    </div> -->
    <!-- <div class="imgContainer notification">
        <img src="../assets/img/Notification 1.png" alt="notification" class="notificationIcon">
    </div> -->
    <div class="imgContainer avatar">
        <img src="../assets/img/avatar2.png" alt="avatar" class="avatarImage">
    </div>
    </header>

    <main class="mainWrapper">
        <article class="peopleChat">
            <section class="connectionsBlock">
                <h2 class="titleBlock">Discussion</h2>
                <div class="messagesList">
                  <div class="messageContainer unread">
                    <div class="avatarContainer">
                      <img class="avatar" src="../assets/img/avatar1.png" alt="avatar">
                    </div>
                    <div class="txtInfos">
                      <h4 class="name">Alexandra Heyman</h4>
                      <p class="titleField">Lorem ipsum dolor sit amet consectetur adipisicing elit. Fuga tempora quam quasi neque suscipit magnam in porro dolore omnis. Veniam corporis ipsa soluta porro modi assumenda doloribus optio neque expedita.</p>
                    </div>
                    <div>
                      <img src="../assets/img/messages.png" class="iconMsg" alt="messages">
                    </div>
                  </div>
                  <div class="messageContainer unread">
                    <div class="avatarContainer">
                      <img class="avatar" src="../assets/img/avatar2.png" alt="avatar">
                    </div>
                    <div class="txtInfos">
                      <h4 class="name">Alexandra Heyman</h4>
                      <p class="titleField">Lorem ipsum dolor sit amet consectetur adipisicing elit. Fuga tempora quam quasi neque suscipit magnam in porro dolore omnis. Veniam corporis ipsa soluta porro modi assumenda doloribus optio neque expedita.</p>
                    </div>
                    <img src="../assets/img/messages.png" class="iconMsg" alt="messages">
                  </div>
                  <div class="messageContainer active">
                    <div class="avatarContainer">
                      <img class="avatar" src="../assets/img/avatar5.png" alt="avatar">
                    </div>
                    <div class="txtInfos">
                      <h4 class="name">Alexandra Heyman</h4>
                      <p class="titleField">Lorem ipsum dolor sit amet consectetur adipisicing elit. Fuga tempora quam quasi neque suscipit magnam in porro dolore omnis. Veniam corporis ipsa soluta porro modi assumenda doloribus optio neque expedita.</p>
                    </div>
                    <img src="../assets/img/messages.png" class="iconMsg" alt="messages">
                  </div>
                  <div class="messageContainer">
                    <div class="avatarContainer">
                      <img class="avatar" src="../assets/img/avatar4.png" alt="avatar">
                    </div>
                    <div class="txtInfos">
                      <h4 class="name">Alexandra Heyman</h4>
                      <p class="titleField">Lorem ipsum dolor sit amet consectetur adipisicing elit. Fuga tempora quam quasi neque suscipit magnam in porro dolore omnis. Veniam corporis ipsa soluta porro modi assumenda doloribus optio neque expedita.</p>
                    </div>
                    <img src="../assets/img/messages.png" class="iconMsg" alt="messages">
                  </div>
                  <div class="messageContainer">
                    <div class="avatarContainer">
                      <img class="avatar" src="../assets/img/avatar3.png" alt="avatar">
                    </div>
                    <div class="txtInfos">
                      <h4 class="name">Alexandra Heyman</h4>
                      <p class="titleField">Lorem ipsum dolor sit amet consectetur adipisicing elit. Fuga tempora quam quasi neque suscipit magnam in porro dolore omnis. Veniam corporis ipsa soluta porro modi assumenda doloribus optio neque expedita.</p>
                    </div>
                    <img src="../assets/img/messages.png" class="iconMsg" alt="messages">
                  </div>
                  <div class="messageContainer">
                    <div class="avatarContainer">
                      <img class="avatar" src="../assets/img/avatar6.png" alt="avatar">
                    </div>
                    <div class="txtInfos">
                      <h4 class="name">Alexandra Heyman</h4>
                      <p class="titleField">Lorem ipsum dolor sit amet consectetur adipisicing elit. Fuga tempora quam quasi neque suscipit magnam in porro dolore omnis. Veniam corporis ipsa soluta porro modi assumenda doloribus optio neque expedita.</p>
                    </div>
                    <img src="../assets/img/messages.png" class="iconMsg" alt="messages">
                  </div>
                  <div class="messageContainer">
                    <div class="avatarContainer">
                      <img class="avatar" src="../assets/img/avatar7.png" alt="avatar">
                    </div>
                    <div class="txtInfos">
                      <h4 class="name">Alexandra Heyman</h4>
                      <p class="titleField">Lorem ipsum dolor sit amet consectetur adipisicing elit. Fuga tempora quam quasi neque suscipit magnam in porro dolore omnis. Veniam corporis ipsa soluta porro modi assumenda doloribus optio neque expedita.</p>
                    </div>
                    <img src="../assets/img/messages.png" class="iconMsg" alt="messages">
                  </div>
                  <div class="messageContainer">
                    <div class="avatarContainer">
                      <img class="avatar" src="../assets/img/avatar8.png" alt="avatar">
                    </div>
                    <div class="txtInfos">
                      <h4 class="name">Alexandra Heyman</h4>
                      <p class="titleField">Lorem ipsum dolor sit amet consectetur adipisicing elit. Fuga tempora quam quasi neque suscipit magnam in porro dolore omnis. Veniam corporis ipsa soluta porro modi assumenda doloribus optio neque expedita.</p>
                    </div>
                    <img src="../assets/img/messages.png" class="iconMsg" alt="messages">
                  </div>
                </div>
              </section>
        </article>

        <article class="commWrapper">
            <section class="messageContainer">
                <div class="personContainer">
                    <div class="avatarContainer">
                        <img class="avatar" src="../assets/img/avatar5.png" alt="avatar">
                    </div>
                    <div class="txtInfos">
                        <h4 class="name">Alexandra Heyman</h4>
                        <p class="titleField">Computer Science</p>
                        <p class="titleField">Alexandra Heyman Nash Peen Integrates Knowledge</p>
                    </div>
                </div>
                <div class="messagesLayout">
                    <p class="message send">
                        Hello how are you today?
                    </p>
                    <p class="message receive">
                        So tired after chirstams Eve. However i canâ€™t wait to go back to work
                    </p>
                    <div class="iframeContainer message send">
                        <div class="iframe" style="background-image: url(https://sil.asc.upenn.edu/exchange/thumbnails/11/1187.jpg);"></div>
                </div>
            </section>

            <section class="keyboardContainer">
                <img src="../assets/img/smile.png" alt="emoji">
                <input class="keyboard" type="text" placeholder="Type your message...">
                <img class="clip" src="../assets/img/clip.png" alt="clip">
                <img class="sendBtn" src="../assets/img/send.png" alt="send">
            </section>
        </article>
    </main>

    <script type="text/javascript">
    
      /**************************
      /* Send Message
      ***************************/
      let messages = document.querySelector('.messagesLayout')
      const sendBtn = document.querySelector('.sendBtn')
      const sendInput = document.querySelector('.keyboard')

      // Button/Enter Key
      sendBtn.addEventListener('click', sendMessage)
      sendInput.addEventListener('keyup', function(e) { 
        if(e.keyCode == 13) sendMessage() 
      })

      // Messenger Functions
      function sendMessage() {
        let message = sendInput.value
        sendInput.value = ''
        writeLine(message)
      }

      function addMessage(e) {
        let message = e.data ? JSON.parse(e.data) : e
        writeLine(`${message.FROM}: ${message.MESSAGE}`)
      }

      function writeLine(text) {
        let message = document.createElement('P')
        message.classList.add('message', 'send')
        message.innerHTML = text
        messages.appendChild(message)
        messages.scrollTop = messages.scrollHeight
      }

      /**************************
      /* AJAX XHR Method
      ***************************/
      function ajax(type, path, data, timeout, func, timeout_func) {
        var xhr = new XMLHttpRequest();
      
        xhr.onload = function() {
          if(this.status === 200){
            func(this.responseText) // call gived function
          }
          else if(this.status === 204) { // no data
            timeout_func() // call timeout function because server closed connection with return code 204 - no content (data)
          }
          else {
            console.log(this.status)
            fail("Unknown status: " + this.status + " status text: " + this.statusText)
          }
        }

        xhr.open(type, path, true)

        if(timeout > 0) {
          xhr.timeout = timeout // set timeout if timeout is bigger than 0

          xhr.ontimeout = function (e) {
            //console.log(e);
            //console.log("timeout");
            timeout_func()
          };
        }

        let fin = new Object() // create new object (for JSON)
        fin.nick = nickname // save nickname
        fin.stranger = chatwith // save stranger nickname
        let json = JSON.stringify(fin) // create JSON

        console.log('fin', fin, 'json', json)

        xhr.setRequestHeader("info", json) // add JSON to header
        xhr.send(data) // send data
      }
    </script>

</body>
</html>